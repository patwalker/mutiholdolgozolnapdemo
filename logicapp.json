{
    "definition": {
        "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
        "contentVersion": "1.0.0.0",
        "triggers": {
            "When_a_HTTP_request_is_received": {
                "type": "Request",
                "kind": "Http"
            }
        },
        "actions": {
            "Trigger_GitHub_Action": {
                "runAfter": {
                    "Get_GitHub_Token": [
                        "Succeeded"
                    ]
                },
                "type": "Http",
                "inputs": {
                    "uri": "https://api.github.com/repos/patwalker/mutiholdolgozolnapdemo/actions/workflows/main.yml/dispatches",
                    "method": "POST",
                    "headers": {
                        "Authorization": "@{concat('Bearer ', body('Get_GitHub_Token')?['value'])}",
                        "Accept": "application/vnd.github.v3+json"
                    },
                    "queries": {
                        "Content-Type": "application/json"
                    },
                    "body": {
                        "ref": "main"
                    }
                },
                "runtimeConfiguration": {
                    "contentTransfer": {
                        "transferMode": "Chunked"
                    }
                }
            },
            "Response_to_User": {
                "runAfter": {
                    "Delay_Before_Redirect": [
                        "Succeeded"
                    ]
                },
                "type": "Response",
                "kind": "Http",
                "inputs": {
                    "statusCode": 200,
                    "headers": {
                        "Content-Type": "text/html"
                    },
                    "body": "<!DOCTYPE html>\n<html lang=\"hu\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta http-equiv=\"refresh\" content=\"5;url=<c√©l static webapp uri>\" />\n  <title>Kezd≈ëdik a Minecraft kalandod!</title>\n  <style>\n    body {\n      font-family: sans-serif;\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      justify-content: center;\n      height: 100vh;\n      background: #f5f5f5;\n      text-align: center;\n      padding: 1rem;\n    }\n    #msg {\n      font-size: 1.5rem;\n      max-width: 600px;\n    }\n  </style>\n</head>\n<body>\n  <div id=\"msg\">\n    <h1>üéÆ Kezd≈ëdik a Minecraft kalandod! üß±</h1>\n    <p>\n      üì± A QR-k√≥d beolvas√°s√°val elind√≠tott√°l egy var√°zslatos g√©pezetet a felh≈ëben. üå©Ô∏è<br><br>\n      üß† K√©pzeld el √∫gy, mintha a LEGO kock√°id üß± nem a polcodon lenn√©nek, hanem egy hatalmas, l√°thatatlan dobozban a neten üåê.<br><br>\n      ü§ñ Amikor beolvastad a k√≥dot, megk√©rt√©l egy l√°thatatlan √©p√≠t≈ërobotot ü§ñ, hogy ezekb≈ël a kock√°kb√≥l gyorsan √©p√≠tsen fel neked egy saj√°t vil√°got üåç.<br><br>\n      üõ†Ô∏è Most √©pp ezt √©p√≠ti ‚Äì p√°r pillanat √©s k√©szen lesz! ‚è≥<br><br>\n      üîÑ Hamarosan automatikusan tov√°bbir√°ny√≠tunk a Minecraft t√©m√°j√∫ alkalmaz√°sodra! üöÄ‚ú®\n    </p>\n  </div>\n</body>\n</html>"
                }
            },
            "Get_GitHub_Token": {
                "runAfter": {},
                "type": "Http",
                "inputs": {
                    "uri": "<your-keyvault-secret-uri>?api-version=7.4",
                    "method": "GET",
                    "authentication": {
                        "type": "ManagedServiceIdentity",
                        "audience": "cfa8b339-82a2-471a-a3c9-0fc0be7a4093"
                    }
                },
                "runtimeConfiguration": {
                    "contentTransfer": {
                        "transferMode": "Chunked"
                    }
                }
            },
            "Delay_Before_Redirect": {
                "runAfter": {
                    "Trigger_GitHub_Action": [
                        "Succeeded"
                    ]
                },
                "type": "Wait",
                "inputs": {
                    "interval": {
                        "count": 1,
                        "unit": "Minute"
                    }
                }
            }
        },
        "outputs": {},
        "parameters": {
            "$connections": {
                "type": "Object",
                "defaultValue": {}
            }
        }
    },
    "parameters": {
        "$connections": {
            "type": "Object",
            "value": {}
        }
    }
}
